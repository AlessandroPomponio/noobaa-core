<div ng-cloak>
    <hr/>
    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Agent Status</h4>
        </div>
        <div class="content-col col-sm-6">
            <table class="table table-no-borders">
                <tr>
                    <th>
                        <i class="fa fa-heartbeat fa-lg fa-fw text-muted"></i>
                        Heartbeat
                    </th>
                    <td>{{node.hearbeat_moment.fromNow()}}</td>
                </tr>
                <tr>
                    <th>
                        <i class="fa fa-tag fa-lg fa-fw text-muted"></i>
                        Version
                    </th>
                    <td>{{node.version}}</td>
                </tr>
            </table>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Hard Drives</h4>
        </div>
        <div class="content-col col-sm-9">
            <table class="table table-no-borders">
                <tr style="border-bottom: 1px dashed #666">
                    <th>Drive</th>
                    <th>
                        OS Usage
                        <i class="fa fa-circle fa-fw" style="color: #03a9f4"></i>
                    </th>
                    <th>
                        NooBaa Usage
                        <i class="fa fa-circle fa-fw" style="color: #ff008b"></i>
                    </th>
                    <th>
                        Free Space
                        <i class="fa fa-circle fa-fw" style="color: #666"></i>
                    </th>
                    <th></th>
                </tr>
                <tr ng-repeat="drive in node.drives">
                    <td>
                        <i class="fa fa-hdd-o fa-lg fa-fw text-muted"></i>
                        {{drive.mount}}
                    </td>
                    <td>{{human_size(drive.storage.used_os)}}</td>
                    <td>
                        <span ng-if="drive.storage.used === undefined">
                            -- not in use --
                        </span>
                        <span ng-if="drive.storage.used !== undefined">
                            {{human_size(drive.storage.used)}}
                        </span>
                    </td>
                    <td>{{human_size(drive.storage.free)}}</td>
                    <td>
                        <div class="progress"
                            style="width: 100px; height: 15px; margin: 2px 0 0 0; background-color: #666">
                            <div aria-valuemax="100" aria-valuemin="0"
                                aria-valuenow="{{drive.storage.used_os_percent}}" class="progress-bar" role="progressbar"
                                style="width: {{drive.storage.used_os_percent}}%; background-color: #03a9f4"></div>
                            <div aria-valuemax="100" aria-valuemin="0"
                                aria-valuenow="{{drive.storage.used_percent}}" class="progress-bar" role="progressbar"
                                style="width: {{drive.storage.used_percent}}%; background-color: #ff008b"></div>
                        </div>
                    </td>
                </tr>
                <tr style="border-top: 1px dashed #666">
                    <th>Total</th>
                    <th>{{human_size(node.storage.used_os)}}</th>
                    <th>{{human_size(node.storage.used)}}</th>
                    <th>{{human_size(node.storage.free)}}</th>
                    <th>
                        <div class="progress"
                            style="width: 100px; height: 15px; margin: 2px 0 0 0; background-color: #666">
                            <div aria-valuemax="100" aria-valuemin="0"
                                aria-valuenow="{{node.storage.used_os_percent}}" class="progress-bar" role="progressbar"
                                style="width: {{node.storage.used_os_percent}}%; background-color: #03a9f4"></div>
                            <div aria-valuemax="100" aria-valuemin="0"
                                aria-valuenow="{{node.storage.used_percent}}" class="progress-bar" role="progressbar"
                                style="width: {{node.storage.used_percent}}%; background-color: #ff008b"></div>
                        </div>
                    </th>
                </tr>
            </table>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Operating System</h4>
        </div>
        <div class="content-col col-sm-9">
            <table class="table table-no-borders">
                <tr>
                    <th>Host Name</th>
                    <td>{{node.os_info.hostname}}</td>
                </tr>
                <tr>
                    <th>Up Time</th>
                    <td>{{node.os_info.uptime_moment.fromNow()}}</td>
                </tr>
                <tr>
                    <th>OS Type</th>
                    <td>{{node.os_info.ostype}}</td>
                </tr>
                <tr>
                    <th>CPUs</th>
                    <td>{{node.os_info.cpus_str}}</td>
                </tr>
                <tr>
                    <th>Memory</th>
                    <td>{{human_size(node.os_info.totalmem)}}</td>
                </tr>
                <tr>
                    <th>Networks</th>
                    <td>
                        <div ng-repeat="addr in node.os_info.addresses">
                            {{addr.address}}
                            - {{addr.name}}
                        </div>
                        <div class="checkbox">
                            <label>
                                <input ng-model="show_ipv6" type="checkbox"/>
                                <small>show IPv6</small>
                            </label>
                        </div>
                        <div ng-if="show_ipv6">
                            <div ng-repeat="addr in node.os_info.addresses6">
                                {{addr.address}}
                                - {{addr.name}}
                            </div>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <hr/>
    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Self Test</h4>
        </div>
        <div class="content-col col-sm-9">
            <button class="btn btn-primary"
                nb-click-ladda="nbNodes.self_test(node, self_test_kind)">Start</button>
            <div style="display: inline-block; width: 150px">
                <select class="form-control" ng-init="self_test_kind='conn'"
                    ng-model="self_test_kind">
                    <option value="conn">Connectivity</option>
                    <option value="rw">Read-Write</option>
                    <option value="load">Load one node</option>
                    <option value="tx">Data Transfer</option>
                    <option value="full">Full</option>
                </select>
            </div>
            <br/>
            <table class="table table-condensed table-no-borders">
                <tr ng-repeat="test in nbNodes.self_test_results">
                    <td>{{test.name}}</td>
                    <td>
                        <span ng-if="test.progress">{{test.progress}}</span>
                        <span ng-if="test.took">( took {{test.took.toFixed(3)}} seconds )</span>
                    </td>
                    <td>
                        <span ng-if="test.start && !test.done && !test.error">
                            <i class="fa fa-spinner fa-spin fa-lg fa-fw"></i>
                        </span>
                        <i class="fa fa-check fa-lg fa-fw text-success" ng-if="test.done"></i>
                        <i class="fa fa-times fa-lg fa-fw text-danger" ng-attr-title="{{test.error}}"
                            ng-if="test.error" rel="tooltip"></i>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <hr/>
</div>
