<div ng-cloak>

    <hr/>

    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Last heartbeat</h4>
            <p><i class="fa fa-heartbeat text-muted" style="font-size: 40px"></i></p>
        </div>
        <div class="content-col col-sm-3">
            {{node.hearbeat_moment.fromNow()}}
        </div>
    </div>

    <hr/>

    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Hard Drives</h4>
            <p><i class="fa fa-hdd-o text-muted" style="font-size: 40px"></i></p>
        </div>
        <div class="content-col col-sm-6">
            <table class="table table-no-borders">
                <tr>
                    <th>Drive</th>
                    <th>NooBaa Used Space</th>
                    <th>Total Space</th>
                    <th>Free Space</th>
                    <th></th>
                </tr>
                <tr ng-repeat="drive in node.drives">
                    <td>{{drive.mount}}</td>
                    <td>{{human_size(drive.storage.used)}}</td>
                    <td>{{human_size(drive.storage.total)}}</td>
                    <td>{{human_size(drive.storage.free)}}</td>
                    <td>
                        <div class="progress" style="margin: 7px 0 0 0">
                            <div class="progress-bar" role="progressbar" aria-valuenow="{{100*(1-drive.storage.used/drive.storage.total)}}" aria-valuemin="0" aria-valuemax="100" style="width: {{100*(1-drive.storage.used/drive.storage.total)}}%; background-color: #03a9f4">
                            </div>
                            <div class="progress-bar" role="progressbar" aria-valuenow="{{100*drive.storage.used/drive.storage.total}}" aria-valuemin="0" aria-valuemax="100" style="width: {{100*drive.storage.used/drive.storage.total}}%; background-color: #ff008b">
                            </div>
                        </div>
                    </td>
                </tr>
                <tr style="border-top: 1px dashed #999">
                    <td>Summary</td>
                    <td>{{human_size(node.storage.used)}}</td>
                    <td>{{human_size(node.storage.total)}}</td>
                    <td>{{human_size(node.storage.free)}}</td>
                </tr>
            </table>
        </div>
    </div>

    <hr/>

    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Operating system</h4>
        </div>
        <div class="content-col col-sm-6">
            <table class="table table-no-borders">
                <tr ng-repeat="(key,val) in node.os_info">
                    <th>{{key}}</th>
                    <td ng-switch="key">
                        <span ng-switch-when="freemem">{{human_size(val)}}</span>
                        <span ng-switch-when="totalmem">{{human_size(val)}}</span>
                        <span ng-switch-when="cpus">{{val.length}}</span>
                        <span ng-switch-when="loadavg">{{val[0].toFixed(1)}} {{val[1].toFixed(1)}} {{val[2].toFixed(1)}}</span>
                        <span ng-switch-when="networkInterfaces">{{_.keys(val).join(', ')}}</span>
                        <span ng-switch-default>{{val}}</span>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <hr/>

    <div class="row">
        <div class="heading-col col-sm-3">
            <h4 class="text-primary">Self test</h4>
        </div>
        <div class="content-col col-sm-9">
            <button class="btn btn-primary" nb-click-ladda="nbNodes.self_test(node, self_test_kind)">Start</button>
            <div style="display: inline-block; width: 150px">
                <select ng-init="self_test_kind='conn'" ng-model="self_test_kind" class="form-control">
                    <option value="conn">Connectivity</option>
                    <option value="rw">Read-Write</option>
                    <option value="load">Load one node</option>
                    <option value="tx">Data Transfer</option>
                    <option value="full">Full</option>
                </select>
            </div>
            <br/>
            <table class="table table-condensed table-no-borders">
                <tr ng-repeat="test in nbNodes.self_test_results">
                    <td>{{test.name}}</td>
                    <td>
                        <span ng-if="test.progress">{{test.progress}}</span>
                        <span ng-if="test.took">( took {{test.took.toFixed(3)}} seconds )</span>
                    </td>
                    <td>
                        <span ng-if="test.start && !test.done && !test.error">
                            <i class="fa fa-spinner fa-spin fa-lg fa-fw"></i>
                        </span>
                        <i ng-if="test.done" class="fa fa-check fa-lg fa-fw text-success"></i>
                        <i ng-if="test.error" class="fa fa-times fa-lg fa-fw text-danger" rel="tooltip" ng-attr-title="{{test.error}}"></i>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <hr/>

</div>
